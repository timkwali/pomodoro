<!DOCTYPE html>
<html>
  <head>
    <meta charset = "utf-8">
    <title>pomodoro.html</title>
  </head>

  <body>
    <h1>Pomodoro</h1>
    <h3>Click the button to start the pomodoro cycle</h3>
    <button>Start</button>
    <div id = "output">
    </div>
    <p id = "counter"></p>
    <p id = "cycle"></p>

    <script>
      function startPomodoro() {
        cycle++; 
        cyc.innerHTML = `Pomodoro Cycles: ${cycle}`;
        counter = 0; // create counter to track number
                    // of times work will be done.
        startWork();
        setTimeout( () => {
          h3.innerHTML = " ";
          h3.innerHTML = "Do long-rest for 15 Minutes";
          minutes = 3;
          start1MinCountdown();
        }, 540000);
        setInterval(startPomodoro, 720000)
      }

      function startWork() {
        counter++;
        count.innerHTML = `Work Counter: ${counter}`;
        console.log(counter);
        
        h3.innerHTML = " ";
        h3.innerHTML = "Work for 25 Minutes";
        minutes = 1;
        start1MinCountdown(); // Work for 25 minutes

        var rest = setTimeout( () => { // Rest for 3 minutes
          h3.innerHTML = " ";
          h3.innerHTML = "Rest now for 3 Minutes";
          minutes = 2;
          start1MinCountdown();
        }, 60000);

        if(counter < 3)
          setTimeout(startWork, 180000);
      }

      function start60SecCountdown() { // start 60 seconds countdown
        seconds--;
        if(seconds < 10) {
          seconds = "0".concat(seconds);
        }
        output.innerHTML = " ";
        if(minutes < 10) {
          output.innerHTML = `0${minutes} Minutes ${seconds} Seconds`;
        } else{
          output.innerHTML = `${minutes} Minutes ${seconds} Seconds`;
        }
        console.log(`${minutes} Minutes ${seconds} Seconds`);

        if(seconds > 0) {
          setTimeout(start60SecCountdown, 1000);
        }
      } // end function
 
      function start1MinCountdown() {
        minutes--;
        seconds = 60;
        start60SecCountdown();
        if(minutes > 0) {
          setTimeout(start1MinCountdown, 60000);
        }
      } 

      function playAlarm() {
        var audio = new Audio("pop.mp3");
        audio.play();
      }
      
    
      let button = document.querySelector("button");
      let countdown = document.querySelector("div");
      let output = document.getElementById("output");
      let h3 = document.querySelector("h3");
      let count = document.getElementById("counter");
      let cyc = document.getElementById("cycle");
      let cycle = 0; // To track number of pomodoros done
      let counter = 0; // Counter to track number 
                      // of work-shortRest cycles
      
      startPomodoro();
    </script>
  </body>
</html>